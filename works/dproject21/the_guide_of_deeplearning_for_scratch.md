# 「ゼロから作るDeep Learning」の歩き方

こんにちは。 @dproject21 です。今回はオライリー・ジャパンから発売されている昨年のベストセラー「ゼロから作るDeep Learning」の書評をしてみようと思います。

昨年の11月から、いろいろな変遷をたどりながらこの本の読書会をやっていました。
（ https://deeplearning-yokohama.connpass.com/ )
ある日の読書会で、新しく来られた方と「これ、なんでそうなるかが理解できないのよね」というなかでディスカッションをしていくなかで「そういうことか！この本、むしろ逆から辿ったほうがわかるんじゃないか？」という話が出ました。

また、Facebookなどを観察していると、多くの方が購入をしているようですが読み切ったという話はあまり見かけず。挫折する、ないしは積読になる、という展開が頻発しているのではないかと考えるようになりました。

そこで、今回は「ゼロから作るDeep Learning」の歩き方と称して、この本のまえがきに「全体像はこんな感じですよー」という解説があったらいいなという妄想をベースに書いていきます。

## そもそもディープラーニングってなんぞや
この本の8章「ディープラーニング」の冒頭にこう書かれています。

"ディープラーニングは、層を深くしたディープなニューラルネットワークです。"

8章まで読み進めてきていれば「そうだよねー」で済んでしまいます。
ですが、いきなりこれを聞くと「ニューラルネットワークって何ぞ」となるわけです。

そこで、この本の3章〜7章にかけて、ニューラルネットワークの解説がなされています。
3章のコラムにて
"「多層パーセプトロン」というと、それはニューラルネットワーク――多層で、シグモイド関数などのなめらかな活性化関数を使用するネットワーク――を指すのが一般的です。"
とあります。

パーセプトロン？シグモイド関数？これまた初学者にはつらい専門用語の世界ですね。
ということで2章ではパーセプトロン、3章ではニューラルネットワークとは何かという点で基本的な用語の解説がなされています。

では、パーセプトロンとは何かというと
"複数の信号を入力として受け取り、ひとつの信号を出力するもの。"
とあり、ソフトウェア的な論理回路として解説がなされています。

...ということは、ディープラーニングとは（この本の中で言うと）画像認識などを行うソフトウェア的な論理回路である、と言い換えられるのではないかと考えています。

## いかにして精度が高く効率が良いニューラルネットワークを作り上げるか

「パーセプトロン」では論理回路の動作調整をする「重み付け」や「バイアス」といったパラメータを人間が決めており、これを機械的に行えるようにしたのが「ニューラルネットワーク」である。とされています。

これらの各種パラメータが既に決まっており、まずはニューラルネットワークを動かしてみよう。動かしてみるなかで、「シグモイド関数」や「入力層」などの基本的な用語を覚えていこう。というのが第3章の内容となります。
では、このパラメータをどうやって機械的に決定できるようにすればいいのか。そのなかでも「重み付け」を決めるための手法が4章・5章で解説されます。

4章では、厳密に計算を行う場合の方法として「数値微分」を使った方法。5章では、より効率がよく精度も保て、実際に使われている「誤差逆伝播法」が紹介されます。

では、重み付け以外のパラメータはどうするのか、あるいは重み付けの初期値はどうすればいいのか、という各種テクニックについて6章で解説をされます。

7章では、実際に至る所で使われている手法のベースとなる「畳み込みニューラルネットワーク（CNN）」の解説がされます。

そして、8章「ディープラーニング」にて、やっとディープラーニングの実装が紹介されます。長い！

## 一番大事なのは5章

この本のなかで最も大事なのはどこか。と聞かれたら「第5章 誤差逆伝播法」だと答えます。

「機械学習」と呼ぶからには、やはり「いかにして学習をするのか」が肝でありましょう。その肝となる方法が解説されているのが第5章となります。
しかも、数学なんて大学で少し学んだくらいで、実務に入ってからは触っていない...という、かしこくないわれわれでも理解できるように「計算グラフ」という形で解説をされています。

ニューラルネットワークの精度を決める「重み付け」の学習方法がバッチリ解説され、しかもソースコードがGitHubにある。本書を片手にソースコードを読んでいけば、間違いなく理解できるようになっています。

## ニューラルネットワークでの計算全体のプロセスは4章

もう一つ大事なのは、ニューラルネットワークで画像解析を行う仕組みを作る際に「どういうプロセスを踏めばよいのか」があります。このプロセスの全体像は第4章で解説されます。単純に書くと...

・全データの一部を近似データとして使う
・近似データを学習し、誤差を求める
・誤差を修正するために、重み付けのパラメータを更新する

というプロセスになります。このプロセスを、求めている精度が得られるまで何度でも繰り返していくのが、ニューラルネットワークでの計算全体のプロセスとなります。

## 実は付録と参考文献も本編

この本を読んでいくなかで、解説に相当のページを割くため付録になっていたり「参考文献を当たってください」となっている箇所があります。
ですが、実はこの付録や参考文献も本編同等の重要性を持っていたりします。

特に参考文献リストのなかにある「パラメータの更新方法」については、海外の論文が参照され、GitHubにあるサンプルコードで実装までなされています。
数式を読み解くためにソースコードを読む。だけど、ソースコードのなかで出てくる変数の意味がわからない...
ということが、私は起きました。結局、実際の論文の一部をあたりながら「ここがこのパラメータなのね」と読み解いていく具合となりました。

## おわりに

ということで、私がこの本を読んでいくなかで、また読書会をするなかで得た「ゼロから作るDeep Learning」の歩き方を紹介していきました。

ぜひ、この本に挫折しそうになったら、この記事を片手に読み進めてもらえればと思います。
最後に、オライリー・ジャパン様のキャンペーンで「ゼロから作るDeep Learning」Tシャツを頂けましたことをご報告しておきます。
